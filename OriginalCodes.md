# Original version #
![http://3-6-9game.googlecode.com/svn/Files/screenshot-00.png](http://3-6-9game.googlecode.com/svn/Files/screenshot-00.png)

Quite amazingly a hard copy of the original source codes survived the years. I scanned the pages and then passed them through OCR software. The codes as shown contains numerous typos since apparently OCR do not work well on dot matrix fonts.

The original version of the game was programmed in BASIC. With that many goto statements and minimal comments/explanations, the codes are quite difficult to follow. Perhaps some may appreciate how messy it was to write (and debug) computer programs back in those days.

The computer play algorithm is ported into level 3 under the "original games rules".


## 1985 source codes written in BASIC ##
Seriously, there are a lot of typos so the codes will not work even if you find a BASIC interpreter or compiler.

```
9V REM KZZZZZZZZKZZEZZZZZZZZZMEZZZZZZ
98 REM INITIALIZATION
99 REM ZZKZ%ZZZZXZZZ%ZKEZZZZZZZZZZZZZ
100 D$ = DHR$ (4)
105 REM REDUCE DDS BUFFER ND 
110 PRINT D$ "HAXFILES 1"
115 REM LDAD NECESSARY FILES
120 PRINT D$ "BLDAD SHQPES,R$9501"
130 POKE 232,1: POKE 233,149
140 PRINT D$ "BLDAD EFFECT,Q$302"
150 HIHEH: 38144
160 DIM 32(9,9), YC(2), P(2), YD(2)
1 0 DIM S$(9,9), L$(81), HF(BI)
175 REM SET UAR    5
180 T1$ = "D$49094912": REM "3-6-9"
190 T2$ = "044 0539232413371730313948" : REH "1/2 PLAYERS  "
200 T3$ = "2824133 173039044331392$13251750": REM "PLAYER 1 5 NAME:"
210 T4$ = "2824133F173039054331392613251 50": REM "PLAYER 2*9 NAME:"
220 T5$ = "CDMPUTER"
230 T6$ = "3132133032" : REM "STQRT"
240 T7$ = "32202126232126193946" : REM "THINKING  "
250 T8$ = "21263413242116391 26323037" : REM "INUALID ENTRY"
260 T9$ = "293321323948" : REH "GUIT  "
2 0 TA$ = "2824133 3913191321263948" : REM "PLHY AGAIN ?"
230 TB$ = "322017393521262617303921313950" : REM "THE HINNER IS :"
2 0 TC$ = "3 273339313213303239182130313248": REM "YDU START FIRST?"
300 XE = 186 : XD = 206
310 YC(I) = 45 : YC(E) = 129
320 YD(I) = 70 : Y0(2) = 154
330 YG = 182
340 ML = D : MH = 1
350 BL = 821 : BH = 830
355 REM POKE MUSIC DATA
360 FOR I = 1 TD 192
370 READ D
380 POKE 39393 + I,D
390 NEXT I
400 DATA 41,30,1,80,1,80,2,80,1,30,1,80,2,80,1,80,1,130,2,148,2
410 DATQ 163,2,80,1,80,1,30,2,80,1,80,1,30,2,130,1,163,1
420 DATA 143,2,121,2,80,2,80,1,30,1,80,2,30,1,80,1,80,2,80,1
430 DQTA BD,I,130,2,148,2,162,2,80,1,163,1,182,5,163,1,148,1,130,2,163,2,130,4
44D DATA D
450 DATA 3D,121,3,121,3,130,3,148,3,143,3,130,3,121,3,100,3,80,4,80,4
460 DATA 100,3,121,3,121,5,100,2,100,7,121,3,121,3,130,3,148,3,148,3
4 0 DATA 130,3,121,3,100,3,80,4,80,4,100,3,121,3,100,5,80,2,80,24
480 D%T% D
490 DATA 22,163,9,182,4,132,15,163,9,148,4,130,15,148,9,163,4,132,9,163,4
500 DATQ 143,20,163,9,182,4,182,15,163,9,148,4,130,15,148,9,163,4,148,9
510 DATA 130,4,130,13
520 DATA 0
525 REH SET SCREEN
530 HDME
540 HGR : POKE - 16302,D
550 HCOLOR= 3
550 SCALE= 1
565 REH INPUT IMFURMATIDN
570 OP = 4
530 M1$ = T1$
590 XM = 110:YM = 10
595 REM PRINT MESSABE
600 GOSUB 4000
610 HPLDT 100,15 TO 173,15
620 M1$ = T2$
530 XN = D:YM = 50
640 GOSUB 4000
650  3 = XA:YS = YA
$55 REM KEYIN
660 GOSUB 3000
670 P = UAL (KE$)
530 IF P > 0 AND P < 3 THEN 710
685 REM CLEAR LINE
690 GOSUB 5310
700 GOTO 660
710 M1$ = T3$
720 XM = 0
730 YM = YM + 20
740 GOSUB 4000
750 XS = XA:YS = YA
760 GOSUB 3000
770 N1$ = KE$
730 IF P = 1 THEN N2$ = T5$: GOTO 370
790 M1$ = T4$
300 YM = YH + 20
310 GOSUB 4000
320 YS = YA
830 GOSUB 3000
340 N2$ = KE$
350 FP = 1
350 GOTO 9 0
370 M1$ = TC$
330 XM = D:YM = YM + 20
890 GOSUB 4000
900 XS = XA:YS = YA
910 GOSUB 3000
920 K$ = LEFT$ (KE$,1)
930 IF K$ = "Y" THEN FP = 1: GOTO 9 0
940 IF K$ = "N" THEN FP = 2: GOTO 979
959 GOSUB 5310
 $0 GOTO 330
 55 REH PLDT SCREEN
 70 HDME
930 HBR : POKE - 16302,0
990 FOR 1 = 13 TD 166 STEP 17
1000 HPLUT 1,12 TD 1,156
1010 HPLUT 1 + 1,12 TU I + 1,15 
1020 NEXT 1
1030 FOR I = 12 TD 156 STEP 16
1040 HPLOT 13,1 TD 166,1
1050 HPLUT 13,1 + 1 TU 167,1 + 1
1060 NEXT 1
1070 K = 17
1030 FOR I = 13 TD 21
1090 DRAM I AT K,6
1100 K = K + 1 
1110 NEXT I
1120 K = 23
1130 FOR I = 4 TD 12
1140 DRAH I AT O,K
1ISD K = K + 16
1160 NEXT I
11 0 HPLOT 173,0 TD 178,166
1180 HPLDT 178,84 TD 279,34
1190 HPLBT 0,166 TD 279,166
1195 REM PRINT SCDRES
1200 DP = 3
1210 GOSUB 4000
1215 REM PRINT IST PLAYER S NAME
1220 OP = 1
1230 GOSUB 4000
1235 REM PRINT ZND PLAYER*S N%ME
1240 UP = 2
1250 GOSUB 4000
1260 DRAH 40 AT 196, 0
12 $ DRAN 40 AT 196,154
1230 XM = IIO:YM = YB
1290 M1$ = T6$
1300 DP = 4
1310 GOSUB 4000
1315 REM PLAY MUSIC 1
1320 POKE ML,227: POKE MH,153
1330 N = PEEK (39394)
1340 FOR I = 1 TO N
1345 REM CALL M C- RDUTINES TD PLAY NOTE
1350 CALL 796
1360 NEXT 1
1370 GOSUB 4UDD



1998 REM ZZEZZZZZZZZXZZZXZZZKZZZZZEZZZ
19 9 REM Z 2
2000 REM Z MAIN PLAY ROUTINE Z
2001 REM Z H
2002 REM ZZZZZZZXZZZZZZZZZEZZZZZZXKZZH
2010 POKE  69,100
2020 P(I) = U:P 2) = 0
2030 XS = XD
2040 YS = YO(FP)
2050 IF P = 1 AND FP = 2 THEN GOSUB 30000: GOTO 2120
2060 GOSUB 3000
2070 GOSUB 6810
EOBB IF LEFT$ (KE$,1) = "G" THEN GOSUB 20010: GOTO 2030
2090 LM$ = KE$
2100 GOSUB 6310
2105 REM IF ERRDR
2110 IF ER THEN GOSUB 6710: GOTO 2050 -
2120 GOSUB 5010
2125 REM IF ERRDR
2130 IF ER THEN GOSUB 6 10: GOTO 2050
2140 GOSUB 6910
2150 IF NDT PS THEN 2210
2155 REM RENEH SCORE
2160 OP = FP
21 0 GOSUB 4000
2130 P(FP) = P(FP) + PS
2190 GOSUB 4000
2200 FOR I = 1 TO 1000: NEXT -
2205 REM SET STATUS
2210 SZ(X,Y) = 1
2220 CN = CN + 1
2230 GOSUB 6910
2235 REM IF GAME DUER
2240 IF EN ) = BI THEN 20160
2250 IF PS THEN 2230
2255 REM SET INDEX
2260 FP = FP + 1
22 0 IF FP ) 2 THEN FP = 1
2230 GOTO 2040



3000 REM *** KEYIN ******
3010 XA = XS:YA = YS
3020 KE$ = ""
3030 IF LEN (KE$) = 9 THEN GOSUB 6810: GOTO 3010
3035 REH DRQN CURSUR
3040 DRAN 42  T XA,YA
3050 GET Q$
3060 IF A$ = ) "A" AND A$ ( = "Z" THEN F = 1: GOTO 3130
3070 IF A$ = ) "D" AND A$ < = "9" THEN F = 1: GOTO 3130
SUBB IF A$ = "-" THEN F = 1: GOTO 3130
3090 IF A$ = " " THEN F = 1: GOTO 3130
3100 IF Q$ = CHR$ (8) THEN F = 2: GOTO 3130
3110 IF %$ = CHR$ (13) THEN F = 3: GOTO 3130
3120 GOTO 3050
3130 DN F GOTO 3140, 3210, 3290
3140 IF X  = ) 258 THEN 3200
3145 M$ = Q$ -
3150 GOSUB 6010
3155 REM ACCEPT A CHQR-
3160 XDRAH 42 AT XA,YQ
3170 DRAN UAL (M1$) AT XA,YA
3180 KE$ = KE$ + A$
3190 XQ = XQ + 11
3200 GOTO 3030

3205 REM "<-"
3210 IF KE$ = "" THEN 3230
3215 M$ = RIGHT$ (KE$,1)
3220 GOSUB 6010
3230 XDRAM 42 AT XQ,YA
3240 XA = XA - 11
3250 XDRAN UAL (M1$) AT XA,YA
3260 IF LEN (KES) = 1 THEN KE$ = "": GOTO 3280
3270 KE$ = LEFT$ (KE$, LEN (KE$) - 1)
3280 GOTO 3030

3285 REM " CR "
3290 XDRAH 42 AT XA,YQ
3300 IF KE$ = "" THEN 3010
3310 RETURN



4000 REM *** PRINT ******
4005 REM SHITCH TD CDRRECT DPERATIUN
4010 DN DP GOSUB 4110, 4110, 4180, 42 0
4020 RETURN

4030 REM E PRINTOUT J
4040 FOR I = 1 TD LEN (M1$) STEP 2
4050 L = UAL ( MID$ (M1$,I,2))
4060 KDR H L QT XA,YA
40 0 XA = XA + 11
4080 NEXT I
4090 RETURN

4100 REM E PRINT SCDRE 1
4110 P$ = STR$ (P(OP))
4120 GOSUB 6510
4130 XA = 213
4140 YA = YC(DP)
4ISU GOSUB 4040
4160 RETURN

4170 REH I PRINT PLAYER3  NEME 1
4180 M$ = N1$
4190 GOSUB 6010
4200 XA = XC + (8 - LEN (N1$)) * 11 / 2
4210 Y% = 20
4220 GOSUB 4040
4230 M$ = N2$
4240 GOSUB 6010
4250 XA = XC + (B - LEN (N2$)) * 11 J 2
4260 YQ = 104
42 0 GOSUB 4040
4280 RETURN
4290 XA = XM:YA = YH
4300 GOSUB 4040
4310 RETURN



SOBD REM *** BHECK SUB, *******
5010 ER = 0
5020 IF SK(X,Y) THEN ER = 1: GOTO 5420
5030 PS = O:L1$ = ""
5040 HC = I:UC = 1
5050 HL$ = "":UL$ = ""
5060 F = D
5070 X$ = STR$ (X)
SOBD Y5 = STR$ (Y)
5085 REM CHECK LEFT HAND SIDE
5090 IF X   2 THEN 5150
5100 FOR I = X - 1 TU 1 STEP - 1
5110 IF NUT SZ(I,Y) THEN 5150
5120 HC = HC + 1
SIBD HL$ = HL$ + STR$ (1) + Y$
5140 NEXT I
5145 REM CHECK RIGHT HHND SIDE
5150 IF X   8 THEN 5210
5160 FOR I = X + 1 TD 9
5170 IF NOT SZ(I,Y) THEN 5210
5130 HC = HC + 1
5190 HL$ = HL$ + STR$ (I) + Y$
5200 NEXT I
5205 REM CHECK UPHARD
521D IF Y ( 2 THEN 5270
5220 FOR I = Y - 1 TO 1 STEP - 1
5230 IF NDT SZ(X,I) THEN 52 0
5240 UC = UB + 1
5250 UL$ = UL$ + X$ + STRS (I)
5260 NEXT I
5265 REM CHECK DOUNHARD
5270 IF Y ) 8 THEN 5330
5280 FOR I = Y + 1 TD 9
52 0 IF NDT SE(X,I) THEN 5330
EBUD UC = UC + 1
5310 UL$ = UL$ + X$ + STR$ (I)
5320 NEXT I
5325 REM INTERPRETATION
5330 IF HC / 3 < ) INT (HC X 3) THEN 5370
5340 F = 1
5350 FS = HC
5360 L1$ = HL$
SBFO IF UC / 3 < ) INT (UE / 35 THEN 5410
5380 F = 1
5390 PS = PS + UC
5400 L1$ = L1$ + UL$
5410 IF F THEN L1$ = X$ + YS + L1$
5420 RETURN



5997 REM XZZZZZZZZZZZMHZXZKZZZZZZZZZZZ
5998 REM SMALL SUBRDUTINES
5P99 REM ZZZXEZZ22%2%22%22%22223%%2%22
6000 REM EQSCII TD SHQPE NU-J
6010 H1$ = "":L = O:K = D
6020 FOR I = 1 TD LEN (M%)
6030 K = %SC ( MID$ (M$,I,1))
6040 IF K = 32 THEN L = 39: GOTO 6090
$050 IF K = 46 THEN L = 41: GOTO 6090
6060 IF K ) 47 AND K < 58 THEN L = K - 45: GOTO 6080
60 0 L = K - 52
6080 IF L < ID THEN M1$ = M1$ + "D"
6090 M1$ = H1$ + STR$ (L)
MDU NBU I
$110 RETURN

6300 REM : ALPHANUMERIC TD NUMERIC 1
5310 IF LM$ = "" THEN 63V0
6320 ER = 0
5330 X = ASC ( LEFT$ (LM$,1)) - 54
5340 Y = UAL ( MID$ (LM$,2,1))
5350 IF X < 1 UR     9 THEN ER = 1
6360 IF Y < 1 DR Y   9 THEN ER = 1
63 0 RETURN

6400 REM : LUC  TD :0  1
6410 XA = 15 + (XI - 1) * 1 
5429 YA = 14 + (YI - 1> * 16
6430 RETURN

5500 REM : NU, TO SHAPE N0  1
5510 H1$ = ""
6520 K = LEN (P$)
5530 IF K < 3 THEN M1$ = "03"
6540 IF K < 2 THEN M1$ = M1$ + "03"
 550 FOR I = 1 TO K
6560 K = UAL < MID$ (P$,I,1)) + 3
65F0 IF K < 10 THEN M1$ = M1$ + "0"
4530 M1$ = H1$ + STR$ (K)
6590 NEXT I
6600 RETURN

6700 REM : PRINT ERROR 1
5 10 M1$ = TB$
5 20 XM = 6B:YM = YG
6 30 UP = 4
6740 PRINT CHR$ ( )
5750 GOSUB 4000
5 50 FOR 1 = 0 TD 1500: NEXT
6770 GOSUB 4000
6 30 RETURN

6800 REM E CLEAR LINE 1
5310 M$ = KE$
6820 GOSUB 5010
6830 XH = XS:YM = YS
5340 DP = 4
6350 GOSUB 4000
6360 RETURN

6900 REM : DRAH SUB  1
5910 IF SZ(X,Y) THEN 695H
6920 XI = X:YI = Y
693U GOSUB 5410
5940 DRAH 1 AT XA,YA
6950 IF L1$ = "" THEN 7020
5950 FOR I = 1 TD LEN (L1$) STEP 2
6970 X1 = UAL < MID$ (L1$,I,1))
5930 YI = UAL < MID$ (L1$,I + 1,1))
5990 GOSUB 5410
7000 XDRAH 2 AT XA,YR
 010 NEXT I
 020 RETURN



1999  REM %2 2% 22222 %%2%%23% 222
19993 REM DUIT   BAME DUER
199$9 REH 22%%%%222222222%222%%2 2
20000 REM E QUIT 1
20010 OP = 4
20020 XM = 106:YM = YG
20030 M1$ = T9$
20040 EDSUB 4000
20050 XS = XA:YS = YA
20060 GOSUB 3000
20070 GOSUB 6310
20030 K$ = LEFT$ (KE$,1)
20090 IF K$ = "Y" THEN 20410
20100 IF K$ = "N" THEN 20120
20110 GOTO 20060
20120 XM = 106:YM = YG
20130 H1$ = T9$
20140 GOSUB 4000
20150 RETURN

20163 REM : GAME DVER 1
20170 XM = 57:YM = YB
20130 M1$ = TB$
20190 DP = 4
20200 EDSUB 4000
20210 IF P(1) ) P<2) THEN J = B6:K = 104: GOTO 20230
20220 J = 95:K = 113
20225 REM PLAY HUSIC 2   FLASH NAME
20230 POKE BL,J: POKE BH,K
20243 POKE ML,55= POKE MH,154
20250 N = PEEK :39473)
20250 FOR 1 = 1 TD N
202 0 CALL  95
20230 CALL 826
20290 NEXT 1
20300 GOSUB 4000

20305 REH PLAT AGAIN
20313 XM = 73
20320 M1$ = TA$
20330 BDBUB 4000
20340 XS = XA:YS = YA
20350 GBSUB 3000
20360 GOSUB 6810
20370 K$ = LEFT$ (KE%,I)
20330 IF K$ = "Y" THEN 370
20390 IF K$ < > "N" THEN 20350

20400 REM : SAY GUDDBYE 1
20410 TEXT : HOME
20420 UTAB 12: HTAB 15
20430 PRINT "BUDDBYE :"
20435 REM PLAY MUSIC 3
20440 POKE ML,117: POKE MH,154
20450 N = PEEK <39540:
20450 FOR 1 = 1 TD N
204 0 CALL  95
20430 NEXT I
20490 END



29995 REM ZZKZZZZKKZZZZXZZZZKZX
29996 REM Z K
29997 REM Z THINK RDUTINE Z
29993 REM Z Z
2 99  REM ZZZHZZKZXZZZZZZXXZZZZ
30000 IF LL$ < > "" THEN 30270
30010 K = FRE (0)
30020 FOR I = 1 TD 9
30030 FOR 11 = 1 TD 9
30040 K = SX(I,II)
30050 :F K THEN 35(1,11) = "O"
30060 IF NOT K THEN S$(I,II) = ""
300 0 NEXT 11
BUDBD NEXT I
30085 REH CHDUSE A CHECKINE DIRECTIUN
30090 K = INT ( RND (1) * 4) + 1
30100 DH K GOTO 30110, 30130, 30150, 301 0
30110 C% = 1 : CB = 9 : CC : 1 : CD = 1 : CE = 9 : CF = 1
30120 GOTO 30180
30130 C% =   : CB = 1 : CC = -1 : CD = 1 : CE = 9 : CF = 1
30140 GBTU 30130
30150 CR = 1 : CB = 9 : CC = 1 : CD = 9 : CE = 1 : CF = -1
30160 GOTO 30180
30170 CA =   : EB = 1 : CC = -1 : CD =   : CE = 1 : CF = -1
30130 11 = 1:I$ = "1"
30185 REM DISPLQY PRDHPT
30190 DP = 4
30200 XM = SS:YM = YG
30210 M1$ = T7$
30220 GOSUB 4010
30225 REM CHECK FOR MDUE
30230 GOSUB 40000
30235 REM IF ND PDINT CQN SCDRE
30240 IF HP = O AND CU ) 1 THEN GBSUB 31000: GOTO 30260
30245 REM IF MDRE TH%N 1 CAN SCDRE
30250 IF LEN (LL$) ) 2 THEN GOSUB 32000
30255 REM CLEAR PRDHPT
30260 GOSUB 4010
3027D X = UAL ( LEFT$ (LL$,1))
30280 Y = URL   MID$ (LL$,2,1))
3Q29O LL$ = MID$ (LL$,3)
30295 REM BIUE % DK SDUND
30300 POKE  68,1
30310 CRLL 7 0
30315 REM PRINT THE MUUE DN BCREEN
30320 XDRQH X + 12 AT XD,YS
30330 KDRAM Y + 3 AT XO + 11,YS
30340 FOR I = 1 TD 2500: NEXT
39345 REH CLEAR THE FRINTINB
30350 XDRAM X + 12 AT XD,YS -
33360 XDRQH Y + 3 AT XU + II,YS
303 0 RETURN



30 9  REM E IF CQNNDT SCDRE )
31000 L$(U) = LC$
31010 LE$ = LC$
31020 LM$ = "":C = D:LHP = D
31030 FOR R = 1 TD LEN (L$ 0)) STEP 2
31040 D = (R + 1) K 2
31050 I$ = STR$ (D)
31060 IF R   19 THEN 1$ = "U" + I$
31070 X = UAL ( MID$ (L$(0),R,1))
31030 Y = UAL ( MID$ (L$(D),R + 1,1))
310$D S$(K,Y3 = S$<X,Y) + I$
31100 GOSUB 40000
31110 LD$ = LL$
31120 FOR 14 = 1 TU LEN (LD$) - 2 STEP 2
31130 FOR 15 = 14 + 2 TD LEN (LD$) STEP 2
31140 IF 15 > LEN (LD$) THEN 31200
31150 IF MID$ (LD$,I4,1) (   MID$ (LD$,I5,1) AND
         MID$ (LD$,I4+1,1)   ) MID$ (LD$,15+1,1) THEN 31190
31168 THF$ = LEFT$ (THP$,(15-1) 1 2) + MID$ (THP$,(15+3) / 2)
31170 LD$ = LEFT$ (LD$,15-1) + MID$ (LD$,15+2)
31180 GOTO 31140
31190 NEXT 15
31200 NEXT 14
31210 HP = D
31220 FOR 14 = 1 TD LEN (THP$)
31230 HP = HP + UAL ( MID$ (THP$,I4,1))
3124U NEXT I
31250 IF HP = D AND 11 = 1 THEN 31390
31260 IF D = 1 THEN LHP = HF
31270 HP(D) = HP
31230 L$(D) = LC$
31290 IF HP = LHP THEN C = C + 1:LM$ = LM$ + 15
31300 IF HP   = LHP THEN 31340
31310 LHP = HP
31320 C = 1
31330 LM$ = I$
31340 NEXT R
31350 IF C = 1 THEN K = U%L (LM$) * 2 - 1: GOTO 31400
31360 K = ( INT ( RND (1) * C) + 1) * 2 - 1
31370 K = UQL ( MID$ (LM$,K,2)) * 2 - 1
31380 GOTO 31400
313 0 K = R
31400 LL$ = MID$ (LE$,K,2)
31410 RETURN



31 99 REM I IF MORE THAN 1 CAN SCDRE 1
32000 GOSUB 33000
32010 FOR I = 1 TO B1
32020 HP(I) = D:L$(I) = ""
32030 NEXT I
32040 IF LD$ = "" THEN 32990
32050 IF LEN (LD$) ) 4 THEN LD$ = LEFT$ (LD$,4) : UHP$ = LEFT$ (OHP$,2)
32060 IF LL$ = "" THEN 32130
320 0 LS$ = LL$
32080 FOR I = 1 TD LEN (LL$) STEP 2
3209U X = VQL ( MID$ (LL$,1,1))
BEIDG Y = UAL ( MID$  LL$,I + 1,1))
32113 S$(X,Y) = "D"
32120 NEXT I
32130 HP(I) = UAL ( LEFT$ (UHP$,1))
32140 HP(Z) = UAL ( MID$ (UHP$,2,1))
32150 H(I) = HP(I):H(E) = HP(Z)
321 0 HA$(1) = "OI":HA$(2) = "02"
32170 L$(1) = LEFT$ (LD$,2):L$<2) = MID$ (LD$,3)
32180 R1 = 0:R2 = 0
32190 31 = I:MU = 1
32200 BA(I) = 2:3(1) = 4
32210 L$(D) = LD$
32220 21 = 0:22 = 0
32230 N1 = 1:0 = 1
32240 IN$(1) = "":IN$(2) = ""
32250 N2 = LEN (L$(D)) / 2
32260 FOR II = 1 TQ CI
32270 FL = 1
32230 FOR IJ = B(II - 1) + 1 TD B(II) STEP 2
32290 IF D > BA(II) / 2 THEN FL = 2
32300 I$ = STR$ (D)
32310 IF D < 10 THEN 1$ = "0" + I$
32320 X$ = MID$ (L$(D),1J,1)
32330 IF X$ = ":" THEN 32750
32340 IF XS = "0" THEN 32330
32350 X = VRL (X$)
32360 Y = $AL ( MIDS (LS(U),IJ + 1,1))
32370 S$EX,Y) = S$(X,Y) + 1$
32330 GOSUB 40000
32390 IF HP = 0 THEN 32750
32400 GOSUB 33000
32410 IF LL$ = "" THEN 32480
32420 FOR 1 = 1 TU LEN (LL$) STEP 2
32430 X = VAL ( MID$ (LL$,I,1))
32440 Y = UAL ( MID$ (LL$,I + 1,1))
32450 S$<X,T) = S$(X,Y) + I$
32450 NEXT I
324 0 L$(D) = L$(D) + LL$
32480 IF LD$ = "" THEN 32630
32490 L$(0> = L$(D) + LEFT$ (LD$,2)
32500 25 = "0" + STR$ (N2 + N1)
32510 2$ = RIBHT$ <2$,2)
32520 FOR 1 = 1 TD LEN (L$(D)) STEP 2
32530 X = UAL ( M1D$ (L$(D),I,1))
32540 Y = UAL ( MIDS (L$(D),I + 1,1))
32550 S$(X,Y) = S$(X,Y) + 2$
325$0 NEXT I
325 0 L$(N2 + NI) = LS(D) + MID$ (LD$,3) + LL$
32580 L$(D) = L$(D) + LEFT$ (LD$,2)
3259U IN$(FL) = IN$(FL) + MID$ (LD$,3)
32500 HP(NZ + NI) = HP(D) + HP + UAL ( MID$ (UHP$,2,1))
32519 N1 = N1 + 1
32620 GOTO 32540
32630 LS(D) = L$(O) + "00"
32640 HP(D) = HP(D) + HP + UAL ( LEFT$ (0HP$,1))
32650 IF R1 THEN H(I) = 0 : R1 = 0 : HA$(1) = ""
32 50 IF RZ THEN H(2> = 0 : R2 = 0 : HA$<2) = ""
32670 IF HP(D) > H(FL) THEN H(FL) = HP(D) : HA$(FL) = I$
32530 IF HP(D) = H(FL) THEN HA$(FL) = HA$(FL) + 1$
32590 IF N1 = 1 THEN 32740
32700 K = N2 + N1 - 1 : K$ = STR$ (K)
32710 IF K < 10 THEN K$ = "0" + K$
32 20 IF HP(K) > H(FL) THEN H(FL) = HP(K):HA$ = K$
BEESU IF HP(K) = H(FL) THEN HA$ = HA$ + K$
32740 GOTO 32730
32 50 L$(D) = L$(U) + "EC"
32760 IF D < = BA(II) / 2 THEN 21 = 21 + 1: GOTO 32 30
32770 22 = 22 + 1
32730 D = D + 1
327 0 NEXT IJ
32300 NEXT II
32810 IF 21 > = MU AND 22 > = N2 - MU THEN 32940
32320 IF 21 > = MU THEN R2 = 1: GOTO 32350
32330 IF 22 > = N2 - MU THEN RI = 1: GOTO 32350
32340 R1 = 1:R2 = 1
32350 N = LEN (IN$(1)):N1 = LEN (1N$(2))
32350 IF N = 0 AND N1 = 0 THEN 32920
32370 CI = 01 + 1
32880 MU = MU + N / 2
32390 BA<C1) = N + B(C1 - 1)
32900 B(CI) = N + N1 + B(CI - 1)
32910 L$(D) = L$(U) + IN$(1) + IN$(2)
32920 L$(U) = HID$ (L$EO),N2 * 2 + 1)
32$30 GOTO 32220
32940 IF H(Z) > H(1) THEN 32970
32950 LL5 = L$( UAL ( LEFT$ (HA$<1),2)1)
329$0 EDTD 32930
329 0 LL$ = L$( UAL < LEFT$ (HA$(2),2)))
32980 LL$ = LS$ + LL$
32990 RETURN



32999 REM ECHEBK DXXDJ
BSDUO LD$ = "":UHP$ = ""
33010 FOR 14 = 1 TU LEN (LL$) - 2 STEP 2
33020 FOR 15 = 14 + 2 TD LEN (LL$) STEP 2
33030 IF 15 > LEN (LL$) THEN 33260
33040 K1$ = MID$ (LL$,I4,1)
33050 K2$ = MID$ (LL$,15,1)
33060 K3$ = MIDS (LL$,I4 + 1,1)
330 0 K4$ = MID$ (LL$,15 + 1,1)
33030 IF K1$ < > K2$ AND K3$ < > K4$ THEN 33250
33090 K1 = UAL (K1$):K2 = UAL (K2$)
33100 K3 = URL (K3$):K4 = UAL (K4$)
33110 SZ(KI,KS) = 1
33120 X = KZ:Y = K4
33130 GOSUB 5010
33140 SZ(KI,KS) = 0
33150 IF PS THEN 33250
33150 UHP$ = MID$ (THP$,(I4+1) / 2,1) + MID$ (THP$,(15+1)   2,1)
33170 THP$ = LEFT$ (THP$,<IS-1) / 2) + MID$ (THP$,<15+3) / 2)
33130 IF 14 = 1 THEN THP$ = MID$ (THP$,2): GOTO 33200
33190 THP$ = LEFT$ (THP$,(I4-1) / 2) + MID$ (THP$,(I4+3) 1 2)
33200 LDS = LD$ + K1$ + K3$ + K2$ + K4$
33210 LL$ = LEFT$ <LL$,I5-1> + MID$ (LL$,15+2)
33220 IF 14 = 1 THEN LL$ = MID$ (LL$,3): GOTO 33240
33230 LL$ = LEFTS (LL$,I4 - 1) + MID$ (LL$,I4 + 2)
33240 GOTO 33030
33250 NEXT 15
33250 NEXT 14
33270 HP = 0
33230 IF THP$ = "" THEN 33320
33290 FOR 14 = 1 TU LEN (THP$)
33300 HP = HP + VAL ( MID$ (THP$,I4,1))
33310 NEXT 14
33320 RETURN



39999 REM E SEARCH J
40000 CU = U:HP = U:LE$ = ""
40010 LL$ = "":LD$ = "":THP$ = ""
40020 XDRAN 46 AT 184,YG
40030 FOR 12 = CR TO CB STEP CC
40040 XDRAH 46 AT 184,YG
40050 FOR 13 = CD TD CE STEP CF
40060 IF S$(12,13) = "U" THEN 40610
40070 FOR I = 1 TD LEN (S$<I2,I3)) STEP 2
40080 IF HID$ (S$(12,13),1,2) = I$ THEN 40610
4UU U NEXT I
40100 PS = D:XI = IZ:YI = 13
40110 HL$ = "":UL$ = ""
40120 HC = I:UC = 1
40130 X1$ = STR$ (XI):Y1$ = STR$ (YI)
40135 REM CHECK LEFT HAND SIDE
40140 IF XI < 2 THEN 40240
40150 FOR 14 = XI - 1 TD 1 STEP - 1
40160 IF S$(14,Y1) = "" THEN 40240
4D170 IF S$(14,Y1) = "U" THEN 40220
40180 FOR I = 1 TD LEN (S$(I4,Y1)) STEP 2
40190 IF MID$ (S$(I4,Y1),I,2) = I$ THEN 40220
40200 NEXT I
40210 GOTO 40240
40220 HC = HC + 1
40230 NEXT 14
40235 REM CHECK RIGHT HAND SIDE
40240 IF XI ) 8 THEN 40340
40250 FOR 14 = XI + 1 TO 9
49260 IF S$(I4,Y1) = "" THEN 40340
40270 IF S$(I4,Y1) = "U" THEN 40320
40280 FOR I = 1 TD LEN (S$(14,Y1)) STEP 2
40290 IF MID$ (S$(I4,Y1),I,2) = I$ THEN 40320
40300 NEXT I
40310 GOTO 40340
40320 HC = HC + 1
40330 NEXT I4
40335 REM CHECK UPMARD
40340 IF YI < 2 THEN 40440
40350 FOR 14 = YI - 1 TU 1 STEP - 1
40360 IF S$(X1,I4) = "" THEN 40440
40370 IF S$(X1,I4) = "O" THEN 40420
40380 FOR I = 1 TU LEN (S$(X1,I4)) STEP 2
40390 IF MID$ (SS(XI,I4),I,2) = I$ THEN 40420
40400 NEXT I
40410 GOTO 40440
40420 UC = UC + 1
40430 NEXT I4
40435 REM CHECK DDHNNARD
40440 IF Y1 ) B THEN 40540
40450 FOR I4 = YI + 1 TO 9
40460 IF S$(X1,I4) = "" THEN 40540
404 0 IF S$(X1,I4) = "U" THEN 40520
40480 FOR I = 1 TD LEN (S$(X1,I4))
40490 IF MID$ (S$(X1,I4),I,2) = I$ THEN 40520
4BSDD NEXT I
40510 GOTO 40540
40520 UC = UC + 1
40530 NEXT I4
40535 REM INTERPRETATIDN
40540 IF HE / 3 = INT (HC X 3) THEN PS = HC
40550 IF UC I 3 = INT (UC / 3) THEN PS = PS + UC
40560 IF PS ) 0 THEN THP$ = THP$ + STR$ (PS) : LL$ = LL$ + X1$ + Y1$
40570 IF PS = HP THEN CU = CU + 1 : LC$ = LC$ + X1$ + Y1$
40530 IF PS < = HP THEN 40610
405 0 HP = PS:BU = 1
40600 LC$ = X1$ + Y1$
40610 NEXT 13
40620 NEXT 12
40630 RETURN

```